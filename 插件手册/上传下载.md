## 概要

> 上传下载主要分为2大类：根据是否指定Servlet分类，即：是否以“withServlet”结尾。 
> 其中以“withServlet”结尾的API，适用于自主开发服务端代码的团队（推荐）；后者指定url，适用于无法自主研发服务端代码、或者Servlet已经封版，不适合修改的团队。

# 1.uploadWithServlet

**功能**

文件上传，将文件（单个文件/批量文件）上传到指定Servlet上（推荐使用）。



**定义**

Mobile.uploadWithServlet(filePath, dataAction, param, callback, err);



**参数**

| 参数名  | 参数类型     | 参数描述     | 参数备注 |
| ---------- | ----------- | -------------- | -------- |
| filePath   | string/array | 上传文件路径       | 必传     |
| dataAction | string   | 服务端Servlet配置（server-data.xml） | 必传     |
| params     | map    | 参数（若服务端不需要，传null）       | 必传     |
| callback   | function     | 执行成功后回调函数     | 选传     |
| err        | function     | 执行失败后的回调函数       | 选传     |



**范例**

```
var picPath = "picture/my.png";    //文件保存名称
//var picPath = ["picture/my.png", "picture/your.jpeg"];    //文件保存名称
var uploadFile = $("#uploadFilePath").html(); //单文件 -> 字符串
//var uploadFile = ["/kevin/imgs/cat.jpg","/kevin/imgs/dog.jpg"];//多文件 -> 数组
var params = Wade.DataMap();
params.put("FILE_DIR", "USER_NAME");        //参数，用户名
params.put("FILE_PATH", picPath);                //参数，文件保存名称
//params.put("FILE_PATH", picPath.toString());   //批量文件上传时，此处需要使用toString
WadeMobile.uploadWithServlet(uploadFile, "UploadDownloadBean.upload", params, function(result){
    var data = new Wade.DataMap(result);
    $("#remoteFilePath").html(data.get("FILE_PATH"));
});
```



**备注**

此接口的回调函数中，返回结果由服务端决定。



# 2.downloadWithServlet

**功能**

文件下载，将文件（单个）下载到指定路径（推荐使用）；



**定义**

Mobile.downloadWithServlet(savePath,dataAction,param,callback,err);



**参数**

| 参数名     | 参数类型 | 参数描述                  | 参数备注 |
| ---------- | -------- | ----------------------- | -------- |
| savePath   | string   | 下载文件路径（以“/”开头为绝对路径[只适用android] | 必传     |
| dataAction | string   | 服务端Servlet配置（server-data.xml）    | 必传 |
| params     | map      | 参数（若服务端不需要，传null）       | 必传     |
| callback   | function | 执行成功后回调函数         | 选传     |
| err        | function | 执行失败后的回调函数           | 选传     |



**范例**

```
var picPath = "picture/cat.png";
var params = new Wade.DataMap();
params.put("USER_NAME", "John"); 
WadeMobile.downloadWithServlet(picPath, "UploadDownloadBean.download", params, function(savePath){
    alert("下载成功，路径:" + savePath);
 }, function(error){
    alert("下载错误:"+error);
});
```



**备注**

此接口的回调函数中，包含下载文件在客户端存储的绝对路径。



# 3. uploadFile

**功能**

文件上传，将文件上传到指定服务接口。不支持除文件本身外还需要其他二进制参数的接口。



**定义**

Mobile.uploadFile(callback, filePath, url, fileKey, extraParams, err);



**参数**

| 参数名     | 参数类型 | 参数描述                     | 参数备注 |
| ---------- | -------- | ---------------------------- | -------- |
| callback   | function | 执行成功后回调函数           | 选传     |
| filePath   | string   | 上传文件路径                 | 必传     |
| url        | string   | 服务接口url                  | 必传     |
| fileKey    | string   | 服务接口接收文件参数对应的key|
| extraParams| string   | JSON格式的字符串，额外参数   | 选传     |
| err        | function | 执行失败后的回调函数         | 选传     |

extraParams中可包含：

| key | value |
|-------|-------|
| method | 请求方法，默认POST |
| headers | 自定义的header信息, JSON格式的字符串 |
| otherBody | 文件之外的请求体参数, JSON格式的字符串 |


**范例**

```
url = "http://www.baidu.com/"
fileKey = 'UPLOAD_FILE0'
filePath = '/storage/emulated/0/share/img.png'
extras = {}
extras.headers = {}
extras.headers.header1 = "fisrt"
extras.otherBody = {}
extras.otherBody.fileCount = 1
extras.method = 'PUT'
extraParams = JSON.stringify(extras)
callback = function(response){}
WadeMobile.upLoadFile(callback, filePath, url, fileKey, extraParams)
```



**备注**

此接口的回调函数中，返回结果由服务端决定。


# 4.downloadFile

**功能**

文件下载，将文件（单个）下载到指定路径；



**定义**

WadeMobile.downloadFile(servletUrl,savePath,callback,err);



**参数**

| 参数名     | 参数类型 | 参数描述                        | 参数备注 |
| ---------- | -------- | ------------------------------ | -------- |
| servletUrl | string   | 服务端Servlet地址（web.xml）        | 必传     |
| savePath   | string   | 下载文件路径（以“/”开头为绝对路径[只适用android] | 必传     |
| callback   | function | 执行成功后回调函数                | 选传     |
| err        | function | 执行失败后的回调函数                  | 选传     |



**范例**

```javascript
IpuMobile.downloadFile(url,null,function(result){
				if(result!="0") {
					alert("下载失败");
				}
			});
```



**备注**

此接口的回调函数中，包含下载文件在客户端存储的绝对路径。

此接口如果需要传参，请自行添加到请求串中。