

## 概要

IpuClient不访问服务端下载服务端代码，本地化运行。


## 过程

首先，修改服务端全局配置文件server-config.xml，文件是否加密配置项，配置成true，重新编译服务端代码，然后将服务端web目录下的前台代码copy至客户端，并将encrypt目录下的template覆盖客户端的template目录，最后重写客户端的MainActivity；

## 实现

1. 修改服务端的server-config.xml文件；

<div>
<img src="../../source/images/run_server_code_locally/server-config.png"  height="270px" width="450px">
</div>

2. 执行服务端的build.xml文件；

<div>
<img src="../../source/images/run_server_code_locally/build.png"  height="239px" width="200px">
</div>

3. 在客户端的assets目录下新增应用名称 文件夹；其中assets下的应用文件名称与mobile-config.xml中的app_path一致；
   ![](本地运行服务端.assets/mobile-config.png)
4. 将服务端 web下的服务端代码复制至客户端的assets/应用名称 文件夹下；

<div>
<img src="../../source/images/run_server_code_locally/web-copy.png"  height="266px" width="400px">
</div>

5. 将服务端encrypt目录下的内容覆盖到客户端的assets/应用名称 文件夹下；

<div>
<img src="../../source/images/run_server_code_locally/encrypt-overwrite.png"  height="352px" width="400px">
</div>

6. 重写MainActivity.java文件，代码如下：

```java
package com.ai.mobile.display;

import android.os.Bundle;

import com.wade.mobile.frame.activity.TemplateMobileActivity;

import com.wade.mobile.frame.template.TemplateManager;

public class MainActivity extends TemplateMobileActivity {

	@Override

	public void onCreate(Bundle savedInstanceState) {

		setTheme(R.style.Theme_Sherlock_Light);

		//设置本地的密钥

		try {

			TemplateManager.initResKey("77777777");

		} catch (Exception e) {

			// TODO Auto-generated catch block

			e.printStackTrace();

		}

		super.onCreate(savedInstanceState);

	}

}

```

> 说明：其中77777777为文件加密秘钥，需与服务端一致；

<div>
<img src="../../source/images/run_server_code_locally/rsa.png"  height="154px" width="500px">
</div>

END


